<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Car Racing Game</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      background: #111;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      overflow: hidden;
    }

    canvas {
      border: 3px solid #fff;
      display: block;
    }

    #score {
      position: absolute;
      top: 15px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 22px;
      color: #fff;
      font-family: Arial, sans-serif;
    }
  </style>
</head>
<body>
  <div id="score">Score: 0</div>
  <canvas id="gameCanvas" width="300" height="500"></canvas>

  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");
    const scoreEl = document.getElementById("score");

    // Load images
    const carImg = new Image();
    carImg.src = "https://i.ibb.co/Yt6dXzL/red-car.png"; 

    const roadImg = new Image();
    roadImg.src = "https://i.ibb.co/7t8GyXj/road-bg.png"; 

    // Load sounds
    const engineSound = new Audio("https://www.soundjay.com/transportation/car-engine-1.mp3");
    const crashSound = new Audio("https://www.soundjay.com/transportation/car-crash-1.mp3");
    const scoreSound = new Audio("https://www.soundjay.com/button/button-09.mp3");

    engineSound.loop = true;

    let car = { x: 130, y: 400, width: 40, height: 70, speed: 5 };
    let obstacles = [];
    let score = 0;
    let gameOver = false;

    // Road scroll
    let roadY = 0;

    function drawRoad() {
      roadY += 4;
      if (roadY >= canvas.height) roadY = 0;
      ctx.drawImage(roadImg, 0, roadY, canvas.width, canvas.height);
      ctx.drawImage(roadImg, 0, roadY - canvas.height, canvas.width, canvas.height);
    }

    function drawCar() {
      ctx.drawImage(carImg, car.x, car.y, car.width, car.height);
    }

    function drawObstacles() {
      ctx.fillStyle = "yellow";
      obstacles.forEach(o => {
        ctx.fillRect(o.x, o.y, o.width, o.height);
      });
    }

    function updateObstacles() {
      obstacles.forEach(o => o.y += 4);
      if (obstacles.length === 0 || obstacles[obstacles.length - 1].y > 120) {
        let x = Math.random() * 240;
        obstacles.push({ x: x, y: -50, width: 50, height: 50 });
      }
      if (obstacles[0].y > 500) {
        obstacles.shift();
        score++;
        scoreEl.textContent = "Score: " + score;
        scoreSound.play();
      }
    }

    function detectCollision() {
      for (let o of obstacles) {
        if (
          car.x < o.x + o.width &&
          car.x + car.width > o.x &&
          car.y < o.y + o.height &&
          car.height + car.y > o.y
        ) {
          crashSound.play();
          gameOver = true;
          engineSound.pause();
        }
      }
    }

    function gameLoop() {
      if (gameOver) {
        ctx.fillStyle = "white";
        ctx.font = "30px Arial";
        ctx.fillText("Game Over", 70, 250);
        ctx.font = "20px Arial";
        ctx.fillText("Refresh to Restart", 60, 290);
        return;
      }

      ctx.clearRect(0, 0, canvas.width, canvas.height);

      drawRoad();
      drawCar();
      drawObstacles();
      updateObstacles();
      detectCollision();

      requestAnimationFrame(gameLoop);
    }

    // Keyboard controls
    document.addEventListener("keydown", e => {
      if (e.key === "ArrowLeft" && car.x > 0) car.x -= car.speed;
      if (e.key === "ArrowRight" && car.x < canvas.width - car.width) car.x += car.speed;
    });

    // Mobile controls
    canvas.addEventListener("touchstart", e => {
      let touchX = e.touches[0].clientX - canvas.getBoundingClientRect().left;
      if (touchX < canvas.width / 2 && car.x > 0) {
        car.x -= car.speed * 3;
      } else if (touchX > canvas.width / 2 && car.x < canvas.width - car.width) {
        car.x += car.speed * 3;
      }
    });

    // Start when assets loaded
    roadImg.onload = () => {
      engineSound.play();
      gameLoop();
    };
  </script>
</body>
</html>
